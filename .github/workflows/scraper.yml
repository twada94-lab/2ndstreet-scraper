- name: Run scraper loop
        run: |
          # 最初に空のファイルを作っておき Gitエラーを防ぐ
          touch latest_count.txt
          
          end=$((SECONDS+21000))
          while [ $SECONDS -lt $end ]; do
            echo "--- Checking: $(date) ---"
            
            # python実行（失敗しても止まらないように || true をつける）
            python scraper_line.py || echo "Script failed, continuing..."

            # 変更があればコミット
            git add latest_count.txt
            if ! git diff --cached --quiet; then
              git commit -m "Update count [bot]"
              git pull --rebase
              git push || echo "Push failed, will try next time"
            fi

            # ★ 10秒は短すぎて即ブロックされるため、最低でも60秒〜を推奨
            echo "Waiting 60 seconds..."
            sleep 60
          done
